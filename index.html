<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizzGame</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    :root {
    --toastify-color-light: #fff;
    --toastify-color-dark: #121212;
    --toastify-color-info: #3498db;
    --toastify-color-success: #07bc0c;
    --toastify-color-warning: #f1c40f;
    --toastify-color-error: #e74c3c;
    --toastify-color-transparent: hsla(0,0%,100%,.7);
    --toastify-icon-color-info: var(--toastify-color-info);
    --toastify-icon-color-success: var(--toastify-color-success);
    --toastify-icon-color-warning: var(--toastify-color-warning);
    --toastify-icon-color-error: var(--toastify-color-error);
    --toastify-toast-width: 320px;
    --toastify-toast-offset: 16px;
    --toastify-toast-top: max(var(--toastify-toast-offset),env(safe-area-inset-top));
    --toastify-toast-right: max(var(--toastify-toast-offset),env(safe-area-inset-right));
    --toastify-toast-left: max(var(--toastify-toast-offset),env(safe-area-inset-left));
    --toastify-toast-bottom: max(var(--toastify-toast-offset),env(safe-area-inset-bottom));
    --toastify-toast-background: #fff;
    --toastify-toast-min-height: 64px;
    --toastify-toast-max-height: 800px;
    --toastify-toast-bd-radius: 6px;
    --toastify-font-family: sans-serif;
    --toastify-z-index: 9999;
    --toastify-text-color-light: #757575;
    --toastify-text-color-dark: #fff;
    --toastify-text-color-info: #fff;
    --toastify-text-color-success: #fff;
    --toastify-text-color-warning: #fff;
    --toastify-text-color-error: #fff;
    --toastify-spinner-color: #616161;
    --toastify-spinner-color-empty-area: #e0e0e0;
    --toastify-color-progress-light: linear-gradient(90deg,#4cd964,#5ac8fa,#007aff,#34aadc,#5856d6,#ff2d55);
    --toastify-color-progress-dark: #bb86fc;
    --toastify-color-progress-info: var(--toastify-color-info);
    --toastify-color-progress-success: var(--toastify-color-success);
    --toastify-color-progress-warning: var(--toastify-color-warning);
    --toastify-color-progress-error: var(--toastify-color-error);
    --toastify-color-progress-bgo: 0.2;
    
    /* Variáveis personalizadas para o QuizzGame */
    --primary-color: #6A5ACD;
    --secondary-color: #483D8B;
    --accent-color: #9370DB;
    --light-color: #E6E6FA;
    --dark-color: #2E2E2E;
    --text-color: #333;
    --error-color: #E74C3C;
    --success-color: #2ECC71;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Roboto', sans-serif;
}

body {
    background-color: var(--light-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    color: var(--text-color);
}

.container {
    width: 100%;
    max-width: 480px;
    padding: 20px;
}

.hidden {
    display: none !important;
}

.authorization-box, .login-box {
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    animation: fadeIn 0.5s ease-out;
    transform-origin: center;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.logo-container {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    padding: 30px 20px;
    text-align: center;
    color: #fff;
    position: relative;
    overflow: hidden;
}

.logo-container h1 {
    font-weight: 700;
    font-size: 24px;
    letter-spacing: 1px;
    margin-top: 15px;
    position: relative;
    z-index: 2;
}

.logo-animation {
    width: 80px;
    height: 80px;
    margin: 0 auto;
    border-radius: 50%;
    position: relative;
    z-index: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: transparent;
}

.logo-img {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
    position: relative;
    z-index: 2;
}

.logo-animation::before, .logo-animation::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 2px solid #fff;
    animation: pulse 2s linear infinite;
    opacity: 0;
}

@keyframes pulse {
    0% {
        transform: scale(0.8);
        opacity: 0.7;
    }
    70% {
        transform: scale(1.3);
        opacity: 0;
    }
    100% {
        transform: scale(1.3);
        opacity: 0;
    }
}

.app-info {
    display: flex;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid #e0e0e0;
}

.app-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    font-weight: bold;
    font-size: 20px;
    margin-right: 15px;
    box-shadow: 0 4px 8px rgba(106, 90, 205, 0.2);
}

.app-details h2 {
    font-size: 18px;
    font-weight: 500;
    margin-bottom: 5px;
}

.app-details p {
    font-size: 14px;
    color: #666;
}

.permissions-list {
    padding: 20px;
    list-style: none;
}

.permissions-list li {
    display: flex;
    align-items: center;
    padding: 10px 0;
    font-size: 14px;
}

.permissions-list svg {
    margin-right: 10px;
    color: var(--primary-color);
}

.buttons {
    display: flex;
    padding: 0 20px 20px;
    justify-content: space-between;
}

button {
    padding: 12px 24px;
    border-radius: 4px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
    font-size: 14px;
}

.cancel-btn {
    background-color: var(--light-color);
    color: var(--dark-color);
}

.cancel-btn:hover {
    background-color: #d8d8d8;
}

.authorize-btn, .login-btn {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: #fff;
    box-shadow: 0 4px 12px rgba(106, 90, 205, 0.3);
}

.authorize-btn:hover, .login-btn:hover {
    background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(106, 90, 205, 0.4);
}

.authorize-btn:active, .login-btn:active {
    transform: translateY(0);
}

.footer {
    padding: 15px 20px;
    background-color: var(--light-color);
    text-align: center;
    font-size: 12px;
    color: #666;
}

.footer a {
    color: var(--primary-color);
    text-decoration: none;
    font-weight: 500;
}

.login-box h2 {
    text-align: center;
    margin: 20px 0;
    font-weight: 500;
    color: var(--dark-color);
}

.form-row {
    display: flex;
    gap: 10px;
    padding: 0 20px;
    margin-bottom: 15px;
}

.form-group {
    flex: 1;
    margin-bottom: 0;
    padding: 0;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-size: 14px;
    color: var(--dark-color);
    font-weight: 500;
    text-align: left;
}

.form-group.ra {
    flex: 2; /* Mais espaço para o RA */
}

.form-group.digit {
    flex: 0.5; /* Menos espaço para o dígito */
}

.form-group.uf {
    flex: 1;
}

.form-group input, .form-group select {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    font-size: 14px;
    transition: all 0.3s;
}

.form-group input:focus, .form-group select:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(106, 90, 205, 0.2);
}

.error-message {
    color: var(--error-color);
    font-size: 13px;
    text-align: center;
    margin: 10px 20px;
    min-height: 20px;
}

.login-btn {
    display: block;
    width: calc(100% - 40px);
    margin: 20px auto 0;
    margin-bottom: 20px;
}

/* Estilos do Toastify */
.Toastify__toast-container {
    box-sizing: border-box;
    color: #fff;
    padding: 4px;
    position: fixed;
    -webkit-transform: translateZ(9999);
    -webkit-transform: translateZ(var(--toastify-z-index));
    width: 320px;
    width: var(--toastify-toast-width);
    z-index: 9999;
    z-index: var(--toastify-z-index)
}

.Toastify__toast-container--top-left {
    left: max(16px,env(safe-area-inset-left));
    left: var(--toastify-toast-left);
    top: max(16px,env(safe-area-inset-top));
    top: var(--toastify-toast-top)
}

.Toastify__toast-container--top-center {
    left: 50%;
    top: max(16px,env(safe-area-inset-top));
    top: var(--toastify-toast-top);
    transform: translateX(-50%)
}

.Toastify__toast-container--top-right {
    right: max(16px,env(safe-area-inset-right));
    right: var(--toastify-toast-right);
    top: max(16px,env(safe-area-inset-top));
    top: var(--toastify-toast-top)
}

.Toastify__toast-container--bottom-left {
    bottom: max(16px,env(safe-area-inset-bottom));
    bottom: var(--toastify-toast-bottom);
    left: max(16px,env(safe-area-inset-left));
    left: var(--toastify-toast-left)
}

.Toastify__toast-container--bottom-center {
    bottom: max(16px,env(safe-area-inset-bottom));
    bottom: var(--toastify-toast-bottom);
    left: 50%;
    transform: translateX(-50%)
}

.Toastify__toast-container--bottom-right {
    bottom: max(16px,env(safe-area-inset-bottom));
    bottom: var(--toastify-toast-bottom);
    right: max(16px,env(safe-area-inset-right));
    right: var(--toastify-toast-right)
}

@media only screen and (max-width: 480px) {
    .Toastify__toast-container {
        left:env(safe-area-inset-left);
        margin: 0;
        padding: 0;
        width: 100vw
    }
    .Toastify__toast-container--top-center,.Toastify__toast-container--top-left,.Toastify__toast-container--top-right {
        top: env(safe-area-inset-top);
        transform: translateX(0)
    }
    .Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-right {
        bottom: env(safe-area-inset-bottom);
        transform: translateX(0)
    }
    .Toastify__toast-container--rtl {
        left: auto;
        right: env(safe-area-inset-right)
    }
}

.Toastify__toast {
    --y: 0;
    border-radius: 6px;
    border-radius: var(--toastify-toast-bd-radius);
    box-shadow: 0 4px 12px rgba(0,0,0,.1);
    box-sizing: border-box;
    cursor: default;
    direction: ltr;
    display: flex;
    font-family: sans-serif;
    font-family: var(--toastify-font-family);
    justify-content: space-between;
    margin-bottom: 1rem;
    max-height: 800px;
    max-height: var(--toastify-toast-max-height);
    min-height: 64px;
    min-height: var(--toastify-toast-min-height);
    overflow: hidden;
    padding: 8px;
    position: relative;
    touch-action: none;
    z-index: 0
}

.Toastify__toast--stacked {
    position: absolute;
    transform: translate3d(0,var(--y),0) scale(var(--s));
    transition: transform .3s;
    width: 100%
}

.Toastify__toast--stacked[data-collapsed] .Toastify__close-button,.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body {
    transition: opacity .1s
}

.Toastify__toast--stacked[data-collapsed=false] {
    overflow: visible
}

.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>* {
    opacity: 0
}

.Toastify__toast--stacked:after {
    bottom: 100%;
    content: "";
    height: calc(var(--g)*1px);
    left: 0;
    position: absolute;
    right: 0
}

.Toastify__toast--stacked[data-pos=top] {
    top: 0
}

.Toastify__toast--stacked[data-pos=bot] {
    bottom: 0
}

.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before {
    transform-origin: top
}

.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before {
    transform-origin: bottom
}

.Toastify__toast--stacked:before {
    bottom: 0;
    content: "";
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    transform: scaleY(3);
    z-index: -1
}

.Toastify__toast--rtl {
    direction: rtl
}

.Toastify__toast--close-on-click {
    cursor: pointer
}

.Toastify__toast-body {
    align-items: center;
    display: flex;
    flex: 1 1 auto;
    margin: auto 0;
    padding: 6px
}

.Toastify__toast-body>div:last-child {
    flex: 1 1;
    word-break: break-word
}

.Toastify__toast-icon {
    display: flex;
    flex-shrink: 0;
    margin-inline-end:10px;width: 20px
}

.Toastify--animate {
    animation-duration: .5s;
    animation-fill-mode: both
}

.Toastify--animate-icon {
    animation-duration: .3s;
    animation-fill-mode: both
}

@media only screen and (max-width: 480px) {
    .Toastify__toast {
        border-radius:0;
        margin-bottom: 0
    }
}

.Toastify__toast-theme--dark {
    background: #121212;
    background: var(--toastify-color-dark);
    color: #fff;
    color: var(--toastify-text-color-dark)
}

.Toastify__toast-theme--colored.Toastify__toast--default,.Toastify__toast-theme--light {
    background: #fff;
    background: var(--toastify-color-light);
    color: #757575;
    color: var(--toastify-text-color-light)
}

.Toastify__toast-theme--colored.Toastify__toast--info {
    background: #3498db;
    background: var(--toastify-color-info);
    color: #fff;
    color: var(--toastify-text-color-info)
}

.Toastify__toast-theme--colored.Toastify__toast--success {
    background: #07bc0c;
    background: var(--toastify-color-success);
    color: #fff;
    color: var(--toastify-text-color-success)
}

.Toastify__toast-theme--colored.Toastify__toast--warning {
    background: #f1c40f;
    background: var(--toastify-color-warning);
    color: #fff;
    color: var(--toastify-text-color-warning)
}

.Toastify__toast-theme--colored.Toastify__toast--error {
    background: #e74c3c;
    background: var(--toastify-color-error);
    color: #fff;
    color: var(--toastify-text-color-error)
}

.Toastify__progress-bar-theme--light {
    background: linear-gradient(90deg,#4cd964,#5ac8fa,#007aff,#34aadc,#5856d6,#ff2d55);
    background: var(--toastify-color-progress-light)
}

.Toastify__progress-bar-theme--dark {
    background: #bb86fc;
    background: var(--toastify-color-progress-dark)
}

.Toastify__progress-bar--info {
    background: #3498db;
    background: var(--toastify-color-progress-info)
}

.Toastify__progress-bar--success {
    background: #07bc0c;
    background: var(--toastify-color-progress-success)
}

.Toastify__progress-bar--warning {
    background: #f1c40f;
    background: var(--toastify-color-progress-warning)
}

.Toastify__progress-bar--error {
    background: #e74c3c;
    background: var(--toastify-color-progress-error)
}

.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning {
    background: hsla(0,0%,100%,.7);
    background: var(--toastify-color-transparent)
}

.Toastify__close-button {
    align-self: flex-start;
    background: transparent;
    border: none;
    color: #fff;
    cursor: pointer;
    opacity: .7;
    outline: none;
    padding: 0;
    transition: .3s ease;
    z-index: 1
}

.Toastify__close-button--light {
    color: #000;
    opacity: .3
}

.Toastify__close-button>svg {
    fill: currentColor;
    height: 16px;
    width: 14px
}

.Toastify__close-button:focus,.Toastify__close-button:hover {
    opacity: 1
}

@keyframes Toastify__trackProgress {
    0% {
        transform: scaleX(1)
    }
    to {
        transform: scaleX(0)
    }
}

.Toastify__progress-bar {
    border-bottom-left-radius: 6px;
    border-bottom-left-radius: var(--toastify-toast-bd-radius);
    bottom: 0;
    height: 100%;
    left: 0;
    opacity: .7;
    position: absolute;
    transform-origin: left;
    width: 100%;
    z-index: 9999;
    z-index: var(--toastify-z-index)
}

.Toastify__progress-bar--animated {
    animation: Toastify__trackProgress linear 1 forwards
}

.Toastify__progress-bar--controlled {
    transition: transform .2s
}

.Toastify__progress-bar--rtl {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 6px;
    border-bottom-right-radius: var(--toastify-toast-bd-radius);
    left: auto;
    right: 0;
    transform-origin: right
}

.Toastify__progress-bar--wrp {
    border-bottom-left-radius: 6px;
    border-bottom-left-radius: var(--toastify-toast-bd-radius);
    bottom: 0;
    height: 5px;
    left: 0;
    position: absolute;
    width: 100%
}

.Toastify__progress-bar--wrp[data-hidden=true] {
    opacity: 0
}

.Toastify__progress-bar--bg {
    height: 100%;
    opacity: .2;
    opacity: var(--toastify-color-progress-bgo);
    width: 100%
}

.Toastify__spinner {
    animation: Toastify__spin .65s linear infinite;
    border: 2px solid #e0e0e0;
    border-color: var(--toastify-spinner-color-empty-area);
    border-radius: 100%;
    border-right-color: #616161;
    border-right-color: var(--toastify-spinner-color);
    box-sizing: border-box;
    height: 20px;
    width: 20px
}

@keyframes Toastify__spin {
    0% {
        transform: rotate(0deg)
    }
    to {
        transform: rotate(1turn)
    }
}
</head>
<body>
    <div class="container">
        <div class="authorization-box" id="authorizationBox">
            <div class="logo-container">
                <div class="logo-animation">
                    <img src="https://i.imgur.com/KtYrhkP.png" alt="QuizzGame Logo" class="logo-img">
                </div>
                <h1>QuizzGame</h1>
            </div>
            
            <div class="app-info">
                <div id="client-abbreviation" class="app-icon">QG</div>
                <div class="app-details">
                    <h2 id="client-name">QuizzGame</h2>
                    <p>solicita permissão para:</p>
                </div>
            </div>
            
            <ul class="permissions-list">
                <li>
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                    <span>Acessar suas informações</span>
                </li>
            </ul>
            
            <div class="buttons">
                <button class="cancel-btn" id="cancelBtn">Cancelar</button>
                <button class="authorize-btn" id="authorizeBtn">Autorizar</button>
            </div>
            
            <div class="footer">
                <p>Não reconhece este aplicativo? <a id="client-site" href="https://quizzgame.vercel.app/">Saiba mais</a></p>
            </div>
        </div>
        
        <div class="login-box hidden" id="loginBox">
            <div class="logo-container">
                <div class="logo-animation">
                    <img src="https://i.imgur.com/KtYrhkP.png" alt="QuizzGame Logo" class="logo-img">
                </div>
                <h1>QuizzGame</h1>
            </div>
            
            <h2>Faça login para continuar</h2>
            
            <form id="loginForm">
                <div class="form-row">
                    <div class="form-group ra">
                        <label for="ra">RA</label>
                        <input type="text" id="ra" name="ra" maxlength="9" placeholder="123456789" required>
                    </div>
                    
                    <div class="form-group digit">
                        <label for="digit">Dígito</label>
                        <input type="text" id="digit" name="digit" maxlength="1" placeholder="x" required>
                    </div>
                    
                    <div class="form-group uf">
                        <label for="uf">UF</label>
                        <select id="uf" name="uf" required>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP" selected>SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group" style="padding: 0 20px;">
                    <label for="password">Senha</label>
                    <input type="password" id="password" name="password" placeholder="Senha" required>
                </div>

                <div class="error-message" id="errorMessage"></div>
                
                <button type="submit" class="login-btn">Entrar</button>
            </form>
            
            <div class="footer">
                <p>Problemas para acessar? <a id="client-support" href="https://github.com/quizzgame">Entre em contato</a></p>
            </div>
        </div>
    </div>
  
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const authorizationBox = document.getElementById('authorizationBox');
            const loginBox = document.getElementById('loginBox');
            const authorizeBtn = document.getElementById('authorizeBtn');
            const cancelBtn = document.getElementById('cancelBtn'); 
            const loginForm = document.getElementById('loginForm');
            const errorMessage = document.getElementById('errorMessage');
            const ufSelect = document.getElementById('uf');            
            
            authorizeBtn.addEventListener('click', function() {
                authorizationBox.classList.add('hidden');
                loginBox.classList.remove('hidden');
            });

            cancelBtn.addEventListener('click', function() {
                location.href = './';
            });
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const ra = document.getElementById('ra').value;
                const digit = document.getElementById('digit').value;
                const uf = document.getElementById('uf').value;
                const password = document.getElementById('password').value;
                
                errorMessage.textContent = '';
                
                if (ra.length !== 9) {
                    showError('O RA deve ter exatamente 9 caracteres.');
                    return;
                }
                
                if (!/^\d+$/.test(ra)) {
                    showError('O RA deve conter apenas números.');
                    return;
                }
                
                if (digit.length !== 1) {
                    showError('O dígito deve ter exatamente 1 caractere.');
                    return;
                }
                
                if (!uf) {
                    showError('Por favor, selecione sua UF.');
                    return;
                }
                
                quizzGameLogin(ra, digit, uf, password);
            });
            
            function showError(message) {
                errorMessage.textContent = message;
            }
            
            async function quizzGameLogin(ra, digit, uf, password) {   
                const loginBtn = loginForm.querySelector('button');
                loginBtn.disabled = true;
                loginBtn.textContent = 'Autenticando...';
                
                try {
                    const quizzGameLoginResponse = await fetch('/api/auth', {
                        'method': 'POST',
                        'headers': {'content-type': 'application/json'},
                        'body': JSON.stringify(
                            {
                                'platform': 'QuizzGame',
                                ra,
                                digit,
                                uf,
                                password
                            }
                        )
                    });
                    
                    const quizzGameLoginJson = await quizzGameLoginResponse.json();

                    const success = !quizzGameLoginJson['token'].includes(btoa('null'));
                        
                    if (success) {
                        errorMessage.textContent = '';
                        const redirParam = 'https://quizzgame.vercel.app/hello';

                        if (redirParam) {
                            try {
                                const targetRedir = new URL(decodeURIComponent(redirParam));
                                
                                targetRedir.searchParams.append('qg_token', quizzGameLoginJson.token);
                            
                                window.location.href = targetRedir.toString();
                            } catch (e) {
                                console.error('Erro ao redirecionar:', e);
                            }
                        } else {
                            location.href = 'https://quizzgame.vercel.app/';
                        }
                    } else {
                        showError('Credenciais inválidas. Por favor, tente novamente.');
                        loginBtn.disabled = false;
                        loginBtn.textContent = 'Entrar';
                    }
                } catch (error) {
                    console.error('Erro na autenticação:', error);
                    showError('Erro ao conectar com o servidor. Tente novamente mais tarde.');
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'Entrar';
                }
            }
        });
    </script>
</body>
</html>
